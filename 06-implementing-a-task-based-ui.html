<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Implementing the User Interface&#8201;&#8212;&#8201;Task-based</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#implementing-the-user-interfacetask-based">Implementing the User Interface&#8201;&#8212;&#8201;Task-based</a>
<ul class="sectlevel2">
<li><a href="#technical-requirements">Technical requirements</a></li>
<li><a href="#api-styles">API Styles</a>
<ul class="sectlevel3">
<li><a href="#crud-based-apis">CRUD-based APIs</a></li>
<li><a href="#task-based-apis">Task-based APIs</a></li>
<li><a href="#task-based-or-crud-based">Task-based or CRUD-based?</a></li>
</ul>
</li>
<li><a href="#bootstrapping-the-ui">Bootstrapping the UI</a></li>
<li><a href="#implementing-the-ui">Implementing the UI</a>
<ul class="sectlevel3">
<li><a href="#model-view-view-model-mvvm-primer">Model View View-Model (MVVM) primer</a></li>
<li><a href="#creating-a-new-lc">Creating a new LC</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
<li><a href="#questions">Questions</a></li>
<li><a href="#further-reading">Further reading</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1 text-justify">
<h2 id="implementing-the-user-interfacetask-based"><a class="anchor" href="#implementing-the-user-interfacetask-based"></a>Implementing the User Interface&#8201;&#8212;&#8201;Task-based</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
To accomplish a difficult task, one must first make it easy.
</blockquote>
<div class="attribution">
&#8212; Marty Rubin
</div>
</div>
<div class="paragraph">
<p>The essence of Domain Driven Design(DDD) is a lot about capturing the business process and user intent a lot more closely. In the previous chapter, we designed a set of APIs without paying a lot of attention to how those APIs would get consumed by its eventual users. In this chapter, we will design the GUI for the LC application using the <a href="https://openjfx.com/">JavaFX</a><sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> framework. As part of that, we will examine how this approach of designing APIs in isolation can cause an impedance mismatch between the producers and the consumers. We will examine the consequences of this <em>impedance mismatch</em> and how task-based UIs can help cope with this mismatch a lot better.</p>
</div>
<div class="paragraph">
<p>In this chapter, we will implement the UI for LC Application and wire up the integration to the backend APIs.  The list of topics to be covered is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>API styles</p>
</li>
<li>
<p>Implementing the UI</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At the end of the chapter, you will learn how to employ DDD principles to help you build robust user experiences that are simple and intuitive. You will also learn why it may be prudent to design your backend interfaces (APIs) from the perspective of the consumer.</p>
</div>
<div class="sect2">
<h3 id="technical-requirements"><a class="anchor" href="#technical-requirements"></a>Technical requirements</h3>
<div class="paragraph">
<p>To follow the examples in this chapter, you will need access to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDK 1.8+ (We have used Java 16 to compile sample sources)</p>
</li>
<li>
<p>JavaFX SDK 16 and SceneBuilder</p>
</li>
<li>
<p>Spring Boot 2.4.x</p>
</li>
<li>
<p>mvvmFX 1.8 (<a href="https://sialcasa.github.io/mvvmFX/" class="bare">https://sialcasa.github.io/mvvmFX/</a>)</p>
</li>
<li>
<p>JUnit 5.7.x (Included with spring boot)</p>
</li>
<li>
<p>TestFX (for UI testing)</p>
</li>
<li>
<p>OpenJFX Monocle (for headless UI testing)</p>
</li>
<li>
<p>Project Lombok (To reduce verbosity)</p>
</li>
<li>
<p>Maven 3.x</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before we dive deep into building the GUI solution, let&#8217;s do a quick recap of where we left the APIs.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-styles"><a class="anchor" href="#api-styles"></a>API Styles</h3>
<div class="paragraph">
<p>If you recall from chapter 5, we created the following commands:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/command-flow.png" alt="command flow" width="488" height="742">
</div>
<div class="title">Figure 1. Commands from the event storming session</div>
</div>
<div class="paragraph">
<p>If you observe carefully, there seem to be commands at two levels of granularity. The "Create LC Application" and "Update LC application" are coarse grained, whereas the others are a lot more focused in terms of their intent. One possible decomposition of the coarse grained commands can be as depicted here:</p>
</div>
<div id="decomposed-commands" class="imageblock text-center">
<div class="content">
<img src="./images/ui-patterns/decomposed-commands.png" alt="decomposed commands">
</div>
<div class="title">Figure 2. Decomposed commands</div>
</div>
<div class="paragraph">
<p>In addition to just being more fine-grained than the commands in the previous iteration, the revised commands seem to better capture the user&#8217;s intent. This may feel like a minor change in semantics, but can have a huge impact on the way our solution is used by its ultimate end-users. The question then is whether we should <em>always</em> prefer fine-grained APIs over coarse grained ones. The answer can be a lot more nuanced. When designing APIs and experiences, we see two main styles being employed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CRUD-based</p>
</li>
<li>
<p>Task-based</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s look at each of these in a bit more detail:</p>
</div>
<div class="sect3">
<h4 id="crud-based-apis"><a class="anchor" href="#crud-based-apis"></a>CRUD-based APIs</h4>
<div class="paragraph">
<p>CRUD is an acronym used to refer to the four basic operations that can be performed on database applications: Create, Read, Update, and Delete. Many programming languages and protocols have their own equivalent of CRUD, often with slight variations in naming and intent. For example, SQL — a popular language for interacting with databases — calls the four functions Insert, Select, Update, and Delete. Similarly, the HTTP protocol has <code>POST</code>, <code>GET</code>, <code>PUT</code> and <code>DELETE</code> as verbs to represent these CRUD operations. This approach has got extended to our design of APIs as well. This has resulted in the proliferation of both CRUD-based APIs and user experiences. Take a look at the <code>CreateLCApplicationCommand</code> from Chapter 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">lombok.Data</span>;

<span style="color:#007">@Data</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CreateLCApplicationCommand</span> {

    <span style="color:#088;font-weight:bold">private</span> LCApplicationId id;

    <span style="color:#088;font-weight:bold">private</span> ClientId clientId;
    <span style="color:#088;font-weight:bold">private</span> Party applicant;
    <span style="color:#088;font-weight:bold">private</span> Party beneficiary;
    <span style="color:#088;font-weight:bold">private</span> AdvisingBank advisingBank;
    <span style="color:#088;font-weight:bold">private</span> LocalDate issueDate;
    <span style="color:#088;font-weight:bold">private</span> MonetaryAmount amount;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> merchandiseDescription;
}
</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Along similar lines, it would not be uncommon to create a corresponding  <code>UpdateLCApplicationCommand</code> as depicted here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">lombok.Data</span>;

<span style="color:#007">@Data</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">UpdateLCApplicationCommand</span> {

    <span style="color:#007">@TargetAggregateIdentifier</span>
    <span style="color:#088;font-weight:bold">private</span> LCApplicationId id;

    <span style="color:#088;font-weight:bold">private</span> ClientId clientId;
    <span style="color:#088;font-weight:bold">private</span> Party applicant;
    <span style="color:#088;font-weight:bold">private</span> Party beneficiary;
    <span style="color:#088;font-weight:bold">private</span> AdvisingBank advisingBank;
    <span style="color:#088;font-weight:bold">private</span> LocalDate issueDate;
    <span style="color:#088;font-weight:bold">private</span> MonetaryAmount amount;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> merchandiseDescription;
}
</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>While this is very common and also very easy to grasp, it is not without problems. Here are some questions that taking this approach raises:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Are we allowed to change everything listed in the <code>update</code> command?</p>
</li>
<li>
<p>Assuming that everything can change, do they all change at the same time?</p>
</li>
<li>
<p>How do we know what exactly changed? Should we be doing a diff?</p>
</li>
<li>
<p>What if all the attributes mentioned above are not included in the <code>update</code> command?</p>
</li>
<li>
<p>What if we need to add attributes in future?</p>
</li>
<li>
<p>Is the business intent of what the user wanted to accomplish captured?</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In a simple system, the answer to these questions may not matter that much. However, as system complexity increases, will this approach remain resilient to change? We feel that it merits taking a look at another approach called task-based APIs to be able to answer these questions.</p>
</div>
</div>
<div class="sect3">
<h4 id="task-based-apis"><a class="anchor" href="#task-based-apis"></a>Task-based APIs</h4>
<div class="paragraph">
<p>In a typical organization, individuals perform tasks relevant to their specialization. The bigger the organization, the higher the degree of specialization. This approach of segregating tasks according to one&#8217;s specialization makes sense, because it mitigates the possibility of stepping on each others' shoes, especially when getting complex pieces of work done. For example, in the LC application process, there is a need to establish the value/legality of the product while also determining the credit worthiness of the applicant. It makes sense that each of these tasks are usually performed by individuals in unrelated departments. It also follows that these tasks can be performed independently from the other.</p>
</div>
<div class="paragraph">
<p>In terms of a business process, if we have a single <code>CreateLCApplicationCommand</code> that precedes these operations, individuals in both departments firstly have to wait for the entire application to be filled out before either can commence their work. Secondly, if either piece of information is updated through a single <code>UpdateLCApplicationCommand</code>, it is unclear what changed. This can result in a spurious notification being sent to at least one department because of this lack of clarity in the process.</p>
</div>
<div class="paragraph">
<p>Since most work happens in the form of specific tasks, it can work to our advantage if our processes and by extension, our APIs mirror these behaviors.</p>
</div>
<div class="paragraph">
<p>Keeping this in mind, let&#8217;s re-examine our revised APIs for the LC application process:</p>
</div>
<div id="revised-commands" class="imageblock text-center">
<div class="content">
<img src="./images/ui-patterns/revised-commands-recap.png" alt="revised commands recap">
</div>
<div class="title">Figure 3. Revised commands</div>
</div>
<div class="paragraph">
<p>While it may have appeared previously that we have simply converted our coarse-grained APIs to become more fine-grained, this in reality is a better representation of the tasks that the user intended to perform. So, in essence, task-based APIs are the decomposition of work in a manner that aligns more closely to the users' intents. With our new APIs, product validation can commence as soon as <code>ChangeMerchandise</code> happens. Also, it is unambiguously clear what the user did and what needs to happen in reaction to the user&#8217;s action. It then begs the question on whether we should employ task-based APIs all the time? Let&#8217;s look at the implications in more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="task-based-or-crud-based"><a class="anchor" href="#task-based-or-crud-based"></a>Task-based or CRUD-based?</h4>
<div class="paragraph">
<p>CRUD-based APIs seem to operate at the level of the aggregate. In our example, we have the LC aggregate. In the simplest case, this essentially translates to four operations aligned with each of the CRUD verbs. However, as we are seeing, even in our simplified version, the LC is becoming a fairly complex concept. Having to work with just four operations at the level of the LC is cognitively complex. With more requirements, this complexity will only continue to increase. For example, consider a situation where  the business expresses a need to capture a lot more information about the <code>merchandise</code>, where today, this is simply captured in the form of free-form text. A more elaborate version of merchandise information is shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Merchandise</span> {
    <span style="color:#088;font-weight:bold">private</span> MerchandiseId id;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Set</span>&lt;Item&gt; items;
    <span style="color:#088;font-weight:bold">private</span> Packaging packaging;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">boolean</span> hazardous;
}

<span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Item</span> {
    <span style="color:#088;font-weight:bold">private</span> ProductId productId;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> quantity;
    <span style="color:#777">// ...</span>
}

<span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Packaging</span> {
    <span style="color:#777">// ...</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In our current design, the implications of this change are far reaching for both the provider and the consumer(s). Let&#8217;s look at some of the consequences in more detail:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Characteristic</th>
<th class="tableblock halign-center valign-top">CRUD-based</th>
<th class="tableblock halign-center valign-top">Task-based</th>
<th class="tableblock halign-left valign-top">Commentary</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Usability</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon red"><i class="fa fa-thumbs-down"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon green"><i class="fa fa-thumbs-up"></i></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task-based interfaces tend to provide more fine-grained controls that capture user intent a lot more explicitly, making them naturally more usable&#8201;&#8212;&#8201;especially in cases where the domain is complex.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reusability</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="red"><span class="icon"><i class="fa fa-thumbs-down"></i></span></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="green"><span class="icon"><i class="fa fa-thumbs-up"></i></span></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task-based interfaces enable more complex features to be composed using simpler ones providing more flexibility to the consumers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scalability</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="red"><span class="icon"><i class="fa fa-thumbs-down"></i></span></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="green"><span class="icon"><i class="fa fa-thumbs-up"></i></span></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task-based interfaces have an advantage because they can provide the ability to independently scale specific features. However, if the fine-grained task-based interfaces are used almost all the time in unison, it may be required to re-examine whether the users' intents are accurately captured.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="red"><span class="icon"><i class="fa fa-thumbs-down"></i></span></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="green"><span class="icon"><i class="fa fa-thumbs-up"></i></span></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For task-based interfaces, security is enhanced from the producer&#8217;s perspective by enabling application of the <em>principle of least privilege<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complexity</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="red"><span class="icon"><i class="fa fa-thumbs-down"></i></span></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="green"><span class="icon"><i class="fa fa-thumbs-up"></i></span></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complexity of the system as a whole is proportional to the number of features that need to be implemented. Assuming accidental complexity is avoided in both cases, task-based interfaces allow spreading complexity more or less uniformly across multiple simpler interfaces.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latency</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="green"><span class="icon"><i class="fa fa-thumbs-up"></i></span></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="red"><span class="icon"><i class="fa fa-thumbs-down"></i></span></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arguably, coarse-grained CRUD interfaces can enable consumers to achieve a lot more in less interactions, thereby providing low latency.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Management Overhead</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="green"><span class="icon"><i class="fa fa-thumbs-up"></i></span></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="red"><span class="icon"><i class="fa fa-thumbs-down"></i></span></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For the provider, fine-grained interfaces require a lot more work managing a larger number of interfaces.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As we can see, the decision between CRUD-based and task-based interfaces is nuanced. We are not suggesting that you should choose one over the other. Which style you use will depend on your specific requirements and context. In our experience, task-based interfaces treat user intents as first class citizens and perpetrate the spirit of DDD&#8217;s ubiquitous language very elegantly. Our preference is to design interfaces as task-based where possible, because they result in more intuitive interfaces that better express the problem domain.</p>
</div>
<div class="paragraph">
<p>As systems evolve, and the support richer user experiences and multiple channels, CRUD-based seem to require additional translation layers to cater to user experience needs. The visual here depicts a typical layered architecture of a solution that supports multiple user experience channels:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/ui-patterns/bff.png" alt="bff">
</div>
</div>
<div class="paragraph">
<p>This set up is usually composed of:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Domain tier comprised of CRUD-based services that simply map closely to database entities.</p>
</li>
<li>
<p>Composite tier comprised of business capabilities that span more than one core service.</p>
</li>
<li>
<p>Backend-for-frontend (<a href="https://philcalcado.com/2015/09/18/the_back_end_for_front_end_pattern_bff.html">BFF</a><sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup>) tier comprised of channel-specific APIs.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Do note that the composite and BFF tiers exist primarily as a means to map backend capabilities to user intent. In an ideal world, where backend APIs reflect user intent closely, the need for translations should be minimal (if at all). Our experience suggests that such a setup causes business logic to get pushed closer to the user channels as opposed to being encapsulated within the confines of well-factored business services. In addition, these tiers cause inconsistent experiences across channels for the same functionality, given that modern teams are structured along tier boundaries.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
We are not opposed to the use of layered architectures. We recognize that a layered architecture can bring modularity, separation of concerns and other related benefits. However, we are opposed to creating additional tiers merely as a means to compensate for poorly factored core domain APIs.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A well factored API tier can have a profound effect on how great user experiences are built. However, this is a chapter on implementing the user interface. Let&#8217;s revert to creating the user interface for the LC application.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bootstrapping-the-ui"><a class="anchor" href="#bootstrapping-the-ui"></a>Bootstrapping the UI</h3>
<div class="paragraph">
<p>We will be building the UI for the LC issuance application we created in <a href="#_implementing_domain_logic">Chapter 5: Implementing Domain Logic</a>. For detailed instructions, refer to the section on <a href="#_bootstapping_the_application"><em>Bootstrapping the application</em></a>. In addition, we will need to add the following dependencies to the <code>dependencies</code> section of the Maven <code>pom.xml</code> file in the root directory of the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td>
  <td class="code"><pre><span style="color:#070;font-weight:bold">&lt;dependencies&gt;</span>
    <span style="color:#777">&lt;!--...--&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.openjfx<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>javafx-controls<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${javafx.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.openjfx<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>javafx-graphics<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${javafx.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.openjfx<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>javafx-fxml<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${javafx.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>de.saxsys<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>mvvmfx<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${mvvmfx.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>de.saxsys<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>mvvmfx-spring-boot<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${mvvmfx.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
    <span style="color:#777">&lt;!--...--&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependencies&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>To run UI tests, you will need to add the following dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td>
  <td class="code"><pre><span style="color:#070;font-weight:bold">&lt;dependencies&gt;</span>
    <span style="color:#777">&lt;!--...--&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.testfx<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>testfx-junit5<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;scope&gt;</span>test<span style="color:#070;font-weight:bold">&lt;/scope&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${testfx-junit5.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.testfx<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>openjfx-monocle<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${openjfx-monocle.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>de.saxsys<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>mvvmfx-testing-utils<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${mvvmfx.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;scope&gt;</span>test<span style="color:#070;font-weight:bold">&lt;/scope&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
    <span style="color:#777">&lt;!--...--&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependencies&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>To be able to run the application from the command line, you will need to add the <code>javafx-maven-plugin</code> to the <code>plugins</code> section of your <code>pom.xml</code>, per the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre><span style="color:#070;font-weight:bold">&lt;plugin&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.openjfx<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>javafx-maven-plugin<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;version&gt;</span>${javafx-maven-plugin.version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;configuration&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;mainClass&gt;</span>com.premonition.lc.ch06.App<span style="color:#070;font-weight:bold">&lt;/mainClass&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/configuration&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/plugin&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>To run the application from the command line, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mvn javafx:run</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using a JDK greater that version 1.8, the JavaFX libraries may not be bundled with the JDK itself. When running the application from your IDE, you will likely need to add the following:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">--module-path=&lt;path-to-javafx-sdk&gt;/lib/ \
   --add-modules=javafx.controls,javafx.graphics,javafx.fxml,javafx.media</code></pre>
</div>
</div>
<div class="paragraph">
<p>We are making use of the mvvmFX framework to assemble the UI. To make this work with spring boot, the application launcher looks as depicted here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td>
  <td class="code"><pre><span style="color:#007">@SpringBootApplication</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">App</span> <span style="color:#088;font-weight:bold">extends</span> MvvmfxSpringApplication { <i class="conum" data-value="1"></i><b>(1)</b>

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        Application.launch(args);
    }

    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> startMvvmfx(Stage stage) {
        stage.setTitle(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">LC Issuance</span><span style="color:#710">&quot;</span></span>);

        <span style="color:#088;font-weight:bold">final</span> Parent parent = FluentViewLoader
                .fxmlView(MainView.class)
                .load().getView();

        <span style="color:#088;font-weight:bold">final</span> Scene scene = <span style="color:#080;font-weight:bold">new</span> Scene(parent);
        stage.setScene(scene);
        stage.show();
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Note that we are required to extend from the mvvmFX framework class <code>MvvmfxSpringApplication</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please refer to the ch06 directory of the accompanying source code repository for the complete example.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="implementing-the-ui"><a class="anchor" href="#implementing-the-ui"></a>Implementing the UI</h3>
<div class="paragraph">
<p>When working with user interfaces, it is fairly customary to use one of these presentation patterns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Model-View-Controller (MVC)</p>
</li>
<li>
<p>Model-View-Presenter (MVP)</p>
</li>
<li>
<p>Model-View-ViewModel (MVVM)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The MVC pattern has been around for the longest time. The idea of separating concerns among collaborating model, view and controller objects is a sound one. However, beyond the definition of these objects, actual implementations seem to vary wildly&#8201;&#8212;&#8201;with the controller becoming overly complex in a lot of cases. In contrast, MVP and MVVM, while being derivatives of MVC, seem to bring out better separation of concerns between the collaborating objects. MVVM, in particular when coupled with data binding constructs, make for code that is much more readable, maintainable and testable. In this book, we make use of MVVM because it enables test-driven development which is a strong personal preference for us. Let&#8217;s look at a quick MVVM primer as implemented in the <code>mvvmfx</code> framework.</p>
</div>
<div class="sect3">
<h4 id="model-view-view-model-mvvm-primer"><a class="anchor" href="#model-view-view-model-mvvm-primer"></a>Model View View-Model (MVVM) primer</h4>
<div class="paragraph">
<p>Modern UI frameworks started adopting a declarative style to express the view. MVVM was designed to remove all GUI code (code-behind) from the view by making use of binding expressions. This allowed for a cleaner separation of stylistic vs. programming concerns. A high level visual of how this pattern is implemented is shown here:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/ui-patterns/mvvm.png" alt="mvvm">
</div>
<div class="title">Figure 4. MVVM design pattern</div>
</div>
<div class="paragraph">
<p>The pattern comprises the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Model</strong>: responsible to house the business logic and managing the state of the application.</p>
</li>
<li>
<p><strong>View</strong>: responsible for presenting data to the user and notifying the view-model about user interactions through the view delegate.</p>
</li>
<li>
<p><strong>View Delegate</strong>: responsible for keeping the view and the view model in sync as changes are made by the user or on the view model. It is also responsible for transmitting actions performed on the view to the view model.</p>
</li>
<li>
<p><strong>View-Model</strong>: responsible for handling user interactions on behalf of the view. The view-model interacts with the view using the observer pattern (typically one-way or two-way data binding to make it more convenient). The view-model interacts with the model for updates and read operations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-new-lc"><a class="anchor" href="#creating-a-new-lc"></a>Creating a new LC</h4>
<div class="paragraph">
<p>Let&#8217;s consider the example of creating a new LC. To start creation of a new LC, all we need is for the applicant to provide a friendly client reference. This is an easy to remember string of free text. A simple rendition of this UI is shown here:</p>
</div>
<div id="start-lc-creation-screen" class="imageblock text-center">
<div class="content">
<img src="./images/mvvm/start-lc-ui.png" alt="start lc ui">
</div>
<div class="title">Figure 5. Start LC creation screen</div>
</div>
<div class="paragraph">
<p>Let&#8217;s examine the implementation and purpose of each component in more detail.</p>
</div>
<div class="sect4">
<h5 id="declarative-view"><a class="anchor" href="#declarative-view"></a>Declarative view</h5>
<div class="paragraph">
<p>When working with JavaFX, the view can be rendered using a declarative style in FXML format. Important excerpts from the <code>StartLCView.fxml</code> file to start creating a new LC are shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
  <td class="code"><pre><span style="color:#777">&lt;?import javafx.scene.layout.Pane?&gt;</span>
<span style="color:#777">&lt;?import javafx.scene.control.Button?&gt;</span>
<span style="color:#777">&lt;?import javafx.scene.control.TextField?&gt;</span>

<span style="color:#070;font-weight:bold">&lt;Pane</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">start-lc</span><span style="color:#710">&quot;</span></span>  <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://javafx.com/javafx/16</span><span style="color:#710">&quot;</span></span>
                      <span style="color:#b48">xmlns:fx</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://javafx.com/fxml/1</span><span style="color:#710">&quot;</span></span>
      <span style="color:#b48">fx:controller</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.premonition.lc.ch06.ui.views.StartLCView</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>      <i class="conum" data-value="1"></i><b>(1)</b>
    ...

    <span style="color:#070;font-weight:bold">&lt;TextField</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">client-reference</span><span style="color:#710">&quot;</span></span>
               <span style="color:#b48">fx:id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">clientReference</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>                                 <i class="conum" data-value="2"></i><b>(2)</b>

    <span style="color:#070;font-weight:bold">&lt;Button</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">start-button</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">fx:id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">startButton</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">text</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Start</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">onAction</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#start</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>                                          <i class="conum" data-value="3"></i><b>(3)</b>
    ...
<span style="color:#070;font-weight:bold">&lt;/Pane&gt;</span>
</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>StartLCView</code> class acts as the view delegate for the FXML view and is assigned using the <code>fx:controller</code> attribute of the root element (<code>javafx.scene.layout.Pane</code> in this case).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to reference <code>client-reference</code> input field in the view delegate, we use the <code>fx:id</code> annotation&#8201;&#8212;&#8201;<code>clientReference</code> in this case.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Similarly, the <code>start-button</code> is referenced using <code>fx:id="startButton"</code> in the view delegate. Furthermore, the <code>start</code> method in the view delegate is assigned to handle the default action (the button press event for <code>javafx.scene.control.Button</code>).</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="view-delegate"><a class="anchor" href="#view-delegate"></a>View delegate</h5>
<div class="paragraph">
<p>Next, let&#8217;s look at the structure of the view delegate <code>com.premonition.lc.issuance.ui.views.StartLCView</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javafx.fxml.FXML</span>;
<span style="color:#777">//...</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCView</span> {                     <i class="conum" data-value="1"></i><b>(1)</b>

    <span style="color:#007">@FXML</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">TextField</span> clientReference;         <i class="conum" data-value="2"></i><b>(2)</b>
    <span style="color:#007">@FXML</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Button</span> startButton;                <i class="conum" data-value="3"></i><b>(3)</b>

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> start(<span style="color:#0a8;font-weight:bold">ActionEvent</span> event) {     <i class="conum" data-value="4"></i><b>(4)</b>
        <span style="color:#777">// Handle button press logic here</span>
    }

    <span style="color:#777">// Other parts omitted for brevity...</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The view delegate class for the <code>StartLCView.fxml</code> view.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The Java binding for the <code>clientReference</code> textbox in the view. The name of the member needs to match exactly with the value of the <code>fx:id</code> attribute in the view. Further, it needs to be annotated with the <code>@javafx.fxml.FXML</code> annotation. The use of the <code>@FXML</code> annotation is optional if the member in the view delegate is <code>public</code> and matches the name in the view.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Similarly, the <code>startButton</code> is bound to the corresponding button widget in the view.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The method for the action handler when the <code>startButton</code> is pressed.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="view-model"><a class="anchor" href="#view-model"></a>View-Model</h5>
<div class="paragraph">
<p>The view-model class <code>StartLCViewModel</code> for the <code>StartLCView</code> is shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td>
  <td class="code"><pre><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javafx.beans.property.StringProperty</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">de.saxsys.mvvmfx.ViewModel</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewModel</span> <span style="color:#088;font-weight:bold">implements</span> ViewModel {       <i class="conum" data-value="1"></i><b>(1)</b>

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> StringProperty clientReference;          <i class="conum" data-value="2"></i><b>(2)</b>

    <span style="color:#088;font-weight:bold">public</span> StartLCViewModel() {
        <span style="color:#950">this</span>.clientReference = <span style="color:#080;font-weight:bold">new</span> SimpleStringProperty(); <i class="conum" data-value="3"></i><b>(3)</b>
    }

    <span style="color:#088;font-weight:bold">public</span> StringProperty clientReferenceProperty() {      <i class="conum" data-value="4"></i><b>(4)</b>
        <span style="color:#080;font-weight:bold">return</span> clientReference;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getClientReference() {
        <span style="color:#080;font-weight:bold">return</span> clientReference.get();
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setClientReference(<span style="color:#0a8;font-weight:bold">String</span> clientReference) {
        <span style="color:#950">this</span>.clientReference.set(clientReference);
    }

    <span style="color:#777">// Other getters and setters omitted for brevity</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The view-model class for the <code>StartLCView</code>. Note that we are required to implement the <code>de.saxsys.mvvmfx.ViewModel</code> interface provided by the mvvmFX framework.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We are initializing the <code>clientReference</code> property using the <code>SimpleStringProperty</code> provided by JavaFX. There are several other property classes to define more complex types. Please refer to the JavaFX documentation for more details.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The value of the <code>clientReference</code> in the view-model. We will look at how to associate this with value of the <code>clientReference</code> textbox in the view shortly. Note that we are using the <code>StringProperty</code> provided by <code>JavaFX</code>, which provides access to the underlying <code>String</code> value of the client reference.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>JavaFX</code> beans are required to create a special accessor for the property itself in addition to the standard getter and setter for the underlying value.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="binding-the-view-to-the-view-model"><a class="anchor" href="#binding-the-view-to-the-view-model"></a>Binding the view to the view-model</h5>
<div class="paragraph">
<p>Next, let&#8217;s look at how to associate the view to the view-model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td>
  <td class="code"><pre><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">de.saxsys.mvvmfx.Initialize</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">de.saxsys.mvvmfx.FxmlView</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">de.saxsys.mvvmfx.InjectViewModel</span>;
<span style="color:#777">//...</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCView</span> <span style="color:#088;font-weight:bold">implements</span> FxmlView&lt;StartLCViewModel&gt; {     <i class="conum" data-value="1"></i><b>(1)</b>

    <span style="color:#007">@FXML</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">TextField</span> clientReference;
    <span style="color:#007">@FXML</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Button</span> startButton;

    <span style="color:#007">@InjectViewModel</span>
    <span style="color:#088;font-weight:bold">private</span> StartLCViewModel viewModel;                              <i class="conum" data-value="2"></i><b>(2)</b>

    <span style="color:#007">@Initialize</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> initialize() {                                      <i class="conum" data-value="3"></i><b>(3)</b>
        clientReference.textProperty()
            .bindBidirectional(viewModel.clientReferenceProperty()); <i class="conum" data-value="4"></i><b>(4)</b>
        startButton.disableProperty()
            .bind(viewModel.startDisabledProperty());                <i class="conum" data-value="5"></i><b>(5)</b>
    }

    <span style="color:#777">// Other parts omitted for brevity...</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The mvvmFX framework requires that the view delegate implement the <code>FXMLView&lt;? extends ViewModelType&gt;</code>. In this case, the view-model type is <code>StartLCViewModel</code>. The mvvmFX framework supports other view types as well. Please refer to the framework documentation for more details.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The framework provides a <code>@de.saxsys.mvvmfx.InjectViewModel</code> annotation to allow dependency injecting the view-model into the view delegate.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The framework will invoke all methods annotated with the <code>@de.saxsys.mvvmfx.Initialize</code> annotation during the initialization process. The annotation can be omitted if the method is named <code>initialize</code> and is declared <code>public</code>. Please refer to the framework documentation for more details.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We have now bound the text property of the <code>clientReference</code> textbox in the view delegate to the corresponding property in the view-model. Note that this is a <strong>bidirectional</strong> binding, which means that the value in the view and the view model are kept in sync if it changes on either side.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>This is another variation of binding in action, where we are making use of a unidirectional binding. Here, we are binding the disabled property of the <code>start</code> button to the corresponding property on the view-model. We will look at why we need to do this shortly.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="enforcing-business-validations-in-the-ui"><a class="anchor" href="#enforcing-business-validations-in-the-ui"></a>Enforcing business validations in the UI</h5>
<div class="paragraph">
<p>We have a business validation that the client reference for an LC needs to be at least 4 characters in length. This will be enforced on the back-end. However, to provide a richer user experience, we will also enforce this validation on the UI.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This may feel contrary to the notion of centralizing business validations on the back-end. While this may be a noble attempt at implementing the DRY (Don&#8217;t Repeat Yourself) principle, in reality, it poses a lot of practical problems. Distributed systems expert&#8201;&#8212;&#8201;Udi Dahan has a very interesting take on why this may not be such a virtuous thing to pursue<sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup>. Ted Neward also talks about this in his blog titled <em>The Fallacies of Enterprise Computing</em><sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The advantage of using MVVM is that this logic is easily testable in a simple unit test of the view-model. Let&#8217;s see this in action test-drive this now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td>
  <td class="code"><pre><span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewModelTests</span> {

    <span style="color:#088;font-weight:bold">private</span> StartLCViewModel viewModel;

    <span style="color:#007">@BeforeEach</span>
    <span style="color:#339;font-weight:bold">void</span> before() {
        <span style="color:#339;font-weight:bold">int</span> clientReferenceMinLength = <span style="color:#00D">4</span>;
        viewModel = <span style="color:#080;font-weight:bold">new</span> StartLCViewModel(clientReferenceMinLength);
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldNotEnableStartByDefault() {
        assertThat(viewModel.getStartDisabled()).isTrue();
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldNotEnableStartIfClientReferenceLesserThanMinimumLength() {
        viewModel.setClientReference(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">123</span><span style="color:#710">&quot;</span></span>);
        assertThat(viewModel.getStartDisabled()).isTrue();
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldEnableStartIfClientReferenceEqualToMinimumLength() {
        viewModel.setClientReference(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1234</span><span style="color:#710">&quot;</span></span>);
        assertThat(viewModel.getStartDisabled()).isFalse();
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldEnableStartIfClientReferenceGreaterThanMinimumLength() {
        viewModel.setClientReference(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">12345</span><span style="color:#710">&quot;</span></span>);
        assertThat(viewModel.getStartDisabled()).isFalse();
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s look at the implementation for this functionality in the view-model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td>
  <td class="code"><pre><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewModel</span> <span style="color:#088;font-weight:bold">implements</span> ViewModel {

    <span style="color:#777">//...</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> StringProperty clientReference;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> BooleanProperty startDisabled;                     <i class="conum" data-value="1"></i><b>(1)</b>

    <span style="color:#088;font-weight:bold">public</span> StartLCViewModel(<span style="color:#339;font-weight:bold">int</span> clientReferenceMinLength) {          <i class="conum" data-value="2"></i><b>(2)</b>
        <span style="color:#950">this</span>.clientReference = <span style="color:#080;font-weight:bold">new</span> SimpleStringProperty();
        <span style="color:#950">this</span>.startDisabled = <span style="color:#080;font-weight:bold">new</span> SimpleBooleanProperty();
        <span style="color:#950">this</span>.startDisabled
            .bind(<span style="color:#950">this</span>.clientReference.length()
                    .lessThan(clientReferenceMinLength));            <i class="conum" data-value="3"></i><b>(3)</b>
    }

    <span style="color:#777">//...</span>
}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCView</span> <span style="color:#088;font-weight:bold">implements</span> FxmlView&lt;StartLCViewModel&gt; {

    <span style="color:#777">//...</span>
    <span style="color:#007">@Initialize</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> initialize() {
        startButton.disableProperty()
            .bind(viewModel.startDisabledProperty());                <i class="conum" data-value="4"></i><b>(4)</b>
        clientReference.textProperty()
            .bindBidirectional(viewModel.clientReferenceProperty());
    }
    <span style="color:#777">//...</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We declare a <code>startDisabled</code> property in the view-model to manage when the start button should be disabled.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The minimum length for a valid client reference is injected into the view-model. It is conceivable that this value will be provided as part of external configuration, or possibly from the back-end.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a binding expression to match the business requirement.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We bind the view-model property to the disabled property of the start button in the view delegate.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s also look at how to write an end-to-end, headless UI test as shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td>
  <td class="code"><pre>
<span style="color:#007">@UITest</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewTests</span> {                                   <i class="conum" data-value="1"></i><b>(1)</b>

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> ApplicationContext context;

    <span style="color:#007">@Init</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> init() {
        MvvmFX.setCustomDependencyInjector(context::getBean);     <i class="conum" data-value="2"></i><b>(2)</b>
    }

    <span style="color:#007">@Start</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> start(Stage stage) {                              <i class="conum" data-value="3"></i><b>(3)</b>
        <span style="color:#088;font-weight:bold">final</span> Parent parent = FluentViewLoader
                .fxmlView(StartLCView.class)
                .load().getView();
        stage.setScene(<span style="color:#080;font-weight:bold">new</span> Scene(parent));
        stage.show();
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> blankClientReference(FxRobot robot) {
        robot.lookup(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#client-reference</span><span style="color:#710">&quot;</span></span>)                         <i class="conum" data-value="4"></i><b>(4)</b>
            .queryAs(<span style="color:#0a8;font-weight:bold">TextField</span>.class)
            .setText(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);

        verifyThat(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#start-button</span><span style="color:#710">&quot;</span></span>, NodeMatchers.isDisabled());   <i class="conum" data-value="5"></i><b>(5)</b>
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> validClientReference(FxRobot robot) {
        robot.lookup(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#client-reference</span><span style="color:#710">&quot;</span></span>)
            .queryAs(<span style="color:#0a8;font-weight:bold">TextField</span>.class)
            .setText(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Test</span><span style="color:#710">&quot;</span></span>);

        verifyThat(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#start-button</span><span style="color:#710">&quot;</span></span>, NodeMatchers.isEnabled());    <i class="conum" data-value="5"></i><b>(5)</b>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We have written a convenience <code>@UITest</code> extension to combine spring framework and TestFX testing. Please refer to the accompanying source code with the book for more details.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We set up the spring context to act as the dependency injection provider for the mvvmFX framework and its injection annotations (for example, <code>@InjectViewModel</code>) to work.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We are using the <code>@Start</code> annotation provided by the TestFX framework to launch the UI.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The TestFX framework injects an instance of the <code>FxRobot</code> UI helper, which we can use to access UI elements.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We are using the The TestFX framework provided convenience matchers for test assertions.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, when we run the application, we can see that the start button is enabled when a valid client reference is entered:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./images/mvvm/valid-client-reference-input.png" alt="valid client reference input">
</div>
<div class="title">Figure 6. The start button is enabled with a valid client reference</div>
</div>
<div class="paragraph">
<p>Now that we have the start button enabling correctly, let&#8217;s implement the actual creation of the LC itself by invoking the backend API.</p>
</div>
</div>
<div class="sect4">
<h5 id="integrating-with-the-backend"><a class="anchor" href="#integrating-with-the-backend"></a>Integrating with the backend</h5>
<div class="paragraph">
<p>LC creation is a complex process, requiring information about a variety of items as evidenced in figure <a href="#revised-commands">Revised commands</a> when we decomposed the LC creation process. In this section, we will integrate the UI with the command to start creation of a new LC. This happens when we press the <em>Start</em> button on the <a href="#start-lc-creation-screen">Start LC creation screen</a>. The revised <code>StartNewLCApplicationCommand</code> looks as shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
  <td class="code"><pre><span style="color:#007">@Data</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartNewLCApplicationCommand</span> {
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> applicantId;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> LCApplicationId id;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> clientReference;

    <span style="color:#088;font-weight:bold">private</span> StartNewLCApplicationCommand(<span style="color:#0a8;font-weight:bold">String</span> applicantId, <span style="color:#0a8;font-weight:bold">String</span> clientReference) {
        <span style="color:#950">this</span>.id = LCApplicationId.randomId();
        <span style="color:#950">this</span>.applicantId = applicantId;
        <span style="color:#950">this</span>.clientReference = clientReference;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> StartNewLCApplicationCommand startApplication( <i class="conum" data-value="1"></i><b>(1)</b>
                    <span style="color:#0a8;font-weight:bold">String</span> applicantId,
                    <span style="color:#0a8;font-weight:bold">String</span> clientReference) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> StartNewLCApplicationCommand(applicantId, clientReference);
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To start a new LC application, we need an <code>applicantId</code> and a <code>clientReference</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Given that we are using the MVVM pattern, the code to invoke the backend service is part of the view-model. Let&#8217;s test-drive this functionality:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td>
  <td class="code"><pre><span style="color:#007">@ExtendWith</span>(MockitoExtension.class)
<span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewModelTests</span> {

    <span style="color:#007">@Mock</span>
    <span style="color:#088;font-weight:bold">private</span> BackendService service;

    <span style="color:#007">@BeforeEach</span>
    <span style="color:#339;font-weight:bold">void</span> before() {
        <span style="color:#339;font-weight:bold">int</span> clientReferenceMinLength = <span style="color:#00D">4</span>;
        viewModel = <span style="color:#080;font-weight:bold">new</span> StartLCViewModel(clientReferenceMinLength, service);
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldNotInvokeBackendIfStartButtonIsDisabled() {
        viewModel.setClientReference(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);
        viewModel.startNewLC();

        Mockito.verifyNoInteractions(service);
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The view-model is enhanced accordingly to inject an instance of the <code>BackendService</code> and looks as shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewModel</span> <span style="color:#088;font-weight:bold">implements</span> ViewModel {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> BackendService service;
    <span style="color:#777">// Other members omitted for brevity</span>

    <span style="color:#088;font-weight:bold">public</span> StartLCViewModel(<span style="color:#339;font-weight:bold">int</span> clientReferenceMinLength,
                            BackendService service) {
        <span style="color:#950">this</span>.service = service;
        <span style="color:#777">// Other code omitted for brevity</span>
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> startNewLC() {
        <span style="color:#777">// TODO: invoke backend!</span>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now a test to actually make sure that the backend gets invoked only when a valid client reference is input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td>
  <td class="code"><pre><span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewModelTests</span> {
    <span style="color:#777">// ...</span>

    <span style="color:#007">@BeforeEach</span>
    <span style="color:#339;font-weight:bold">void</span> before() {
        viewModel = <span style="color:#080;font-weight:bold">new</span> StartLCViewModel(<span style="color:#00D">4</span>, service);
        viewModel.setLoggedInUser(<span style="color:#080;font-weight:bold">new</span> LoggedInUserScope(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test-applicant</span><span style="color:#710">&quot;</span></span>));   <i class="conum" data-value="1"></i><b>(1)</b>
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldNotInvokeBackendIfStartButtonIsDisabled() {
        viewModel.setClientReference(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);
        viewModel.startNewLC();

        Mockito.verifyNoInteractions(service);                                <i class="conum" data-value="2"></i><b>(2)</b>
    }

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldInvokeBackendWhenStartingCreationOfNewLC() {
        viewModel.setClientReference(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">My first LC</span><span style="color:#710">&quot;</span></span>);
        viewModel.startNewLC();

        Mockito.verify(service).startNewLC(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test-applicant</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">My first LC</span><span style="color:#710">&quot;</span></span>);  <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We set the logged in user</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When the client reference is blank, there should be no interactions with the backend service.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When a valid value for the client reference is entered, the backend should be invoked with the entered value.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The implementation to make this test pass, then looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td>
  <td class="code"><pre><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewModel</span> {
    <span style="color:#777">//...</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> startNewLC() {
        <span style="color:#080;font-weight:bold">if</span> (!getStartDisabled()) {                  <i class="conum" data-value="1"></i><b>(1)</b>
            service.startNewLC(
                    userScope.getLoggedInUserId(),
                    getClientReference());          <i class="conum" data-value="2"></i><b>(2)</b>
        }
    }
    <span style="color:#777">//...</span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We check that the start button is enabled before invoking the backend.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The actual backend call with the appropriate values.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now let&#8217;s look at how to integrate the backend call from the view. We test this in a UI test as shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td>
  <td class="code"><pre><span style="color:#007">@UITest</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewTests</span> {

    <span style="color:#007">@MockBean</span>
    <span style="color:#088;font-weight:bold">private</span> BackendService service;                                   <i class="conum" data-value="1"></i><b>(1)</b>

    <span style="color:#777">//...</span>

    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldLaunchLCDetailsWhenCreationIsSuccessful(FxRobot robot) {
        <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> clientReference = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">My first LC</span><span style="color:#710">&quot;</span></span>;
        LCApplicationId lcApplicationId = LCApplicationId.randomId();

        when(service.startNewLC(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test-applicant</span><span style="color:#710">&quot;</span></span>, clientReference))
                .thenReturn(lcApplicationId);                         <i class="conum" data-value="2"></i><b>(2)</b>

        robot.lookup(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#client-reference</span><span style="color:#710">&quot;</span></span>)
            .queryAs(<span style="color:#0a8;font-weight:bold">TextField</span>.class)
            .setText(clientReference);                                <i class="conum" data-value="3"></i><b>(3)</b>
        robot.clickOn(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#start-button</span><span style="color:#710">&quot;</span></span>);                               <i class="conum" data-value="4"></i><b>(4)</b>

        Mockito.verify(service).startNewLC(
                <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test-applicant</span><span style="color:#710">&quot;</span></span>, clientReference);                   <i class="conum" data-value="5"></i><b>(5)</b>

        verifyThat(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#lc-details-screen</span><span style="color:#710">&quot;</span></span>, isVisible());                <i class="conum" data-value="6"></i><b>(6)</b>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We inject a mock instance of the backend service.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We stub the call to the backend to return successfully.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We type in a valid value for the client reference.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We click on the <code>start</code> button.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We verify that the service was indeed invoked with the correct arguments.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We verify that we have moved to the next screen in the UI (the LC details screen).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s also look at what happens when the service invocation fails in another test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCViewTests</span> {
    <span style="color:#777">//...</span>
    <span style="color:#007">@Test</span>
    <span style="color:#339;font-weight:bold">void</span> shouldStayOnCreateLCScreenOnCreationFailure(FxRobot robot) {
        <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> clientReference = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">My first LC</span><span style="color:#710">&quot;</span></span>;
        when(service.startNewLC(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test-applicant</span><span style="color:#710">&quot;</span></span>, clientReference))
            .thenThrow(<span style="color:#080;font-weight:bold">new</span> <span style="color:#C00;font-weight:bold">RuntimeException</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Failed!!</span><span style="color:#710">&quot;</span></span>));   <i class="conum" data-value="1"></i><b>(1)</b>

        robot.lookup(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#client-reference</span><span style="color:#710">&quot;</span></span>)
            .queryAs(<span style="color:#0a8;font-weight:bold">TextField</span>.class)
            .setText(clientReference);
        robot.clickOn(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#start-button</span><span style="color:#710">&quot;</span></span>);

        verifyThat(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#start-lc-screen</span><span style="color:#710">&quot;</span></span>, isVisible());        <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We stub the backend service call to fail with an exception.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We verify that we continue to remain on the <code>start-lc-screen</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The view implementation for this functionality is shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td>
  <td class="code"><pre><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javafx.concurrent.Service</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StartLCView</span> {
    <span style="color:#777">//...</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> start(<span style="color:#0a8;font-weight:bold">ActionEvent</span> event) {
        <span style="color:#080;font-weight:bold">new</span> Service&lt;<span style="color:#0a8;font-weight:bold">Void</span>&gt;() {                    <i class="conum" data-value="1"></i><b>(1)</b>
            <span style="color:#007">@Override</span>
            <span style="color:#088;font-weight:bold">private</span> Task&lt;<span style="color:#0a8;font-weight:bold">Void</span>&gt; createTask() {
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> Task&lt;&gt;() {
                    <span style="color:#007">@Override</span>
                    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Void</span> call() {
                        viewModel.startNewLC();  <i class="conum" data-value="2"></i><b>(2)</b>
                        <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">null</span>;
                    }
                };
            }

            <span style="color:#007">@Override</span>
            <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> succeeded() {
                Stage stage = UIUtils.getStage(event);
                showLCDetailsView(stage);        <i class="conum" data-value="3"></i><b>(3)</b>
            }

            <span style="color:#007">@Override</span>
            <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> failed() {
                <span style="color:#777">// Nothing for now. Remain on the same screen.</span>
            }
        }.start();
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>JavaFX, like most frontend frameworks, is single-threaded and requires that long-running tasks not be invoked on the UI thread. For this purpose, it provides the <code>javafx.concurrent.Service</code> abstraction to handle such interactions elegantly in a background thread.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The actual invocation of the backend through the view-model happens here.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We show the next screen to enter more LC details here.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, the service implementation itself is shown here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td>
  <td class="code"><pre><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.axonframework.commandhandling.gateway.CommandGateway</span>;

<span style="color:#007">@Service</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BackendService</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> CommandGateway gateway;                         <i class="conum" data-value="1"></i><b>(1)</b>

    <span style="color:#088;font-weight:bold">public</span> BackendService(CommandGateway gateway) {
        <span style="color:#950">this</span>.gateway = gateway;
    }

    <span style="color:#088;font-weight:bold">public</span> LCApplicationId startNewLC(<span style="color:#0a8;font-weight:bold">String</span> applicantId, <span style="color:#0a8;font-weight:bold">String</span> clientReference) {
        <span style="color:#080;font-weight:bold">return</span> gateway.sendAndWait(                               <i class="conum" data-value="2"></i><b>(2)</b>
                  startApplication(applicantId, clientReference)
               );
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We inject the <code>org.axonframework.commandhandling.gateway.CommandGateway</code> provided by the Axon framework to invoke the command.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The actual invocation of the backend using the <code>sendAndWait</code> method happens here. In this case, we are blocking until the backend call completes. There are other variations that do not require this kind of blocking. Please refer to the Axon framework documentation for more details.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We have now seen a complete example of how to implement the UI and invoke the backend API.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="summary"><a class="anchor" href="#summary"></a>Summary</h3>
<div class="paragraph">
<p>In this chapter, we looked the nuances of API styles and clarified why it is very important to design APIs that capture the users' intent closely. We looked at the differences between CRUD-based and task-based APIs. Finally, we implemented the UI making use of the MVVM design pattern and demonstrated how it aids in test-driving frontend functionality.</p>
</div>
<div class="paragraph">
<p>Now that we have implemented the creation of new LC, for implementing the subsequent commands we will require access to an existing LC.  In the next chapter, we will look at how to implement the query side and how to keep it in sync with the command side.</p>
</div>
</div>
<div class="sect2">
<h3 id="questions"><a class="anchor" href="#questions"></a>Questions</h3>
<div class="ulist">
<ul>
<li>
<p>What kind of APIs do you come up with in your domain? CRUD-based? Task-based? Something else?</p>
</li>
<li>
<p>How do consumers find your APIs? Do they have to implement further translations of your APIs to consume them meaningfully?</p>
</li>
<li>
<p>Are you able to test-drive your front-end functionality? Do you see merit in this approach?</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="further-reading"><a class="anchor" href="#further-reading"></a>Further reading</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Title</th>
<th class="tableblock halign-left valign-top">Author</th>
<th class="tableblock halign-left valign-top">Location</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task-drien user interfaces</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oleksandr Sukholeyster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.uxmatters.com/mt/archives/2014/12/task-driven-user-interfaces.php" class="bare">https://www.uxmatters.com/mt/archives/2014/12/task-driven-user-interfaces.php</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business logic, a different perspective</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Udi Dahan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://vimeo.com/131757759" class="bare">https://vimeo.com/131757759</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Fallacies of Enterprise Computing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ted Neward</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://blogs.tedneward.com/post/enterprise-computing-fallacies/" class="bare">http://blogs.tedneward.com/post/enterprise-computing-fallacies/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GUI architectures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Martin Fowler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://martinfowler.com/eaaDev/uiArchs.html" class="bare">https://martinfowler.com/eaaDev/uiArchs.html</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. <a href="https://openjfx.com/" class="bare">https://openjfx.com/</a>
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" class="bare">https://en.wikipedia.org/wiki/Principle_of_least_privilege</a>
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. <a href="https://philcalcado.com/2015/09/18/the_back_end_for_front_end_pattern_bff.html" class="bare">https://philcalcado.com/2015/09/18/the_back_end_for_front_end_pattern_bff.html</a>
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. <a href="https://vimeo.com/131757759" class="bare">https://vimeo.com/131757759</a>
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. <a href="http://blogs.tedneward.com/post/enterprise-computing-fallacies/" class="bare">http://blogs.tedneward.com/post/enterprise-computing-fallacies/</a>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.0-SNAPSHOT<br>
Last updated 2022-05-12 00:43:39 UTC
</div>
</div>
</body>
</html>